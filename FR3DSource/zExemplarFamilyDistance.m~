
load PairExemplars

% Pair codes:  1-AA 5-AC 6-CC 7-GC 9-AG 11-GG 13-AU 14-CU 15-GU 16-UU

pcodes = [1 5 6 7 9 11 13 14 15 16];    % pair codes to work on

[s,t] = size(Exemplar);

for p = 1:length(pcodes),
  for q = p:length(pcodes),
    for a = 1:s,                        % loop through exemplars for pcodes(a)
      P1 = Exemplar(a,pcodes(p));
      c1 = P1.Class;
      if c1 == fix(c1),                 % not a subcategory of this family
        for b = 1:s,                    % loop through exemplars for pcodes(b)
                    
        if Exemplar(



for a = 1:length(B),
  for b = (a+1):length(B),

    R1 = B(a).NT2.Rot' * B(a).NT1.Rot;
    R2 = B(b).NT1.Rot' * B(b).NT2.Rot;

    ang = zAngleOfRotation(R1 * R2);

    t1 = (B(a).NT2.Sugar(1,:) - B(a).NT1.Sugar(1,:))*B(a).NT1.Rot - (B(b).NT2.Sugar(1,:) - B(b).NT1.Sugar(1,:))*B(b).NT1.Rot;
    t2 = (B(a).NT1.Sugar(1,:) - B(a).NT2.Sugar(1,:))*B(a).NT2.Rot - (B(b).NT1.Sugar(1,:) - B(b).NT2.Sugar(1,:))*B(b).NT2.Rot;

    cp = abs(norm(B(a).NT2.Sugar(1,:) - B(a).NT1.Sugar(1,:)) ...
           - norm(B(b).NT2.Sugar(1,:) - B(b).NT1.Sugar(1,:)));

    % calculate isodiscrepancy

    D(a,b) = sqrt((4*ang)^2 + (t1*t1' + t2*t2')/2 + (3*cp)^2);
    D(b,a) = D(a,b);

    G(j,:) = [6*ang sqrt(t1*t1') sqrt(t2*t2') 3*cp a b D(a,b)];
    j = j + 1;

  end
end
