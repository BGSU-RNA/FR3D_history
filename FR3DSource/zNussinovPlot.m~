% zNussinovPlot(Edge,Color) plots the basepairs in Edge using Color as
% chords of a circle

function [void] = zNussinovPlot(Edge,Color,Thickness)

if nargin < 3,
  Thickness = 1;
end

if nargin < 2,
  Color = sparse(zeros(size(Edge)));
  Color(1,1) = 1;
end

[i,j] = find(Edge);

if length(i) > 0,

for k = 1:length(i),
  c(k) = Color(i(k),j(k));
end

[y,k] = sort(-abs(c));           % sort by decreasing color
i = i(k);
j = j(k);

[s,t] = size(Edge);

tp = -6.2;
theta = 0:-0.01:tp;
plot(cos(theta), sin(theta),'k');
hold on

for k = 1:s,
  if mod(k,10) == 0,
    theta = k*tp/s;
    plot([cos(theta) 1.02*cos(theta)], [sin(theta), 1.02*sin(theta)],'k');
  end
  if mod(k,100) == 0,
    theta = k*tp/s;
    plot([cos(theta) 1.04*cos(theta)], [sin(theta), 1.04*sin(theta)],'k');
    text(1.11*cos(theta)-0.06, 1.08*sin(theta), num2str(k));
  end

end


map = colormap;

colorletter = 'bcrgymbcrgymbcrgymbcrgym';

for k = 1:length(i),
%  c   = 1 + fix(63*(Color(i(k),j(k)))/max(max(Color)));
  if Color(i(k),j(k)) > 0,
    c = colorletter(Color(i(k),j(k)));

    plot([cos(i(k)*tp/s) cos(j(k)*tp/s)], [sin(i(k)*tp/s) sin(j(k)*tp/s)],c,'LineWidth',Thickness);
  end
end
axis square
axis([-1.2 1.2 -1.2 1.2]);
axis off

end
