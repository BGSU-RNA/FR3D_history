% zExemplarTablesExcel collects tables of discrepancies formatted for Excel

TT = {};
UU = {};

for c = 1:12,
  [T,U] = zExemplarTable(c,1,0,1);
  [a,b] = size(T);
  [c,d] = size(TT);

  TT((c+2):(c+1+a),1:b) = T;
end

xlswrite('c:\IsoDiscrepancyTables2.xls',TT);
Excel = actxserver('Excel.Application');
Excel.Workbooks.Open('c:\IsoDiscrepancyTables2.xls');

Lett = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';

[c,d] = size(TT);
for i = 1:c,
  Range = Excel.Range(['AA' num2str(i)]);
  Range.Interior.ColorIndex = min(56,i);
  for j = 6:d,
    if strcmp(class(TT{i,j}),'double') && ~isempty(TT{i,j}),
      Range = Excel.Range([Lett(j) num2str(i)]);
      if TT{i,j} < 2,
        Range.Interior.ColorIndex = 3;
      elseif TT{i,j} < 3.3,
        Range.Interior.ColorIndex = 6;
      elseif TT{i,j} < 5.5,
        Range.Interior.ColorIndex = 8;
      else 
        Range.Interior.ColorIndex = 5;
      end
    end
  end
end

%Range.Font.ColorIndex = 42;
Excel.Visible=1;
